<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <title>CivicReceipt – 2024 slices</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <style>
    :root {
      --bg: #0f172a;
      --panel: #111827;
      --text: #e2e8f0;
      --muted: #94a3b8;
      --border: rgba(148, 163, 184, 0.15);
      --accent: #22c55e;
      --accent2: #2563eb;
    }
    body {
      background: radial-gradient(circle at top, #1f2937 0%, #0f172a 65%);
      color: var(--text);
      font-family: system-ui, -apple-system, BlinkMacSystemFont, "Segoe UI", sans-serif;
      margin: 0;
      padding: 2rem;
      display: flex;
      justify-content: center;
    }
    .container {
      width: min(1000px, 100%);
      background: rgba(15, 23, 42, 0.75);
      border: 1px solid var(--border);
      border-radius: 1rem;
      padding: 1.5rem 1.75rem 2rem;
      backdrop-filter: blur(4px);
    }
    h1 { font-size: 1.35rem; margin-bottom: 0.25rem; }
    p.subtitle { color: var(--muted); margin-top: 0; margin-bottom: 1.25rem; font-size: 0.9rem; }
    .grid { display: grid; grid-template-columns: repeat(auto-fit, minmax(200px, 1fr)); gap: 1rem; }
    label { display: block; margin-bottom: 0.4rem; font-weight: 500; }
    input[type="number"], select {
      width: 100%; padding: 0.5rem 0.6rem; border-radius: 0.5rem;
      border: 1px solid rgba(148, 163, 184, 0.2); background: rgba(15, 23, 42, 0.3);
      color: var(--text); font-size: 0.9rem;
    }
    .category-list {
      display: grid; grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 0.4rem 1.25rem; margin-top: 1.25rem; margin-bottom: 0.9rem;
    }
    .category-list label {
      display: flex; align-items: center; gap: 0.35rem; font-weight: 400;
      cursor: pointer; color: var(--text);
    }
    .cat-inputs {
      margin-top: 1rem;
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 0.75rem;
    }
    .cat-box {
      background: rgba(15, 23, 42, 0.35);
      border: 1px solid rgba(148, 163, 184, 0.12);
      border-radius: 0.6rem;
      padding: 0.6rem 0.7rem 0.7rem;
      font-size: 0.8rem;
    }
    .cat-box strong { display: block; margin-bottom: 0.15rem; }
    .cat-box small { color: var(--muted); }
    button {
      background: var(--accent2); border: none; color: #fff; padding: 0.6rem 1.1rem;
      border-radius: 0.6rem; font-weight: 600; cursor: pointer; margin-top: 1rem;
    }
    button:hover { background: #1d4ed8; }
    .results {
      margin-top: 1.4rem;
      background: rgba(15, 23, 42, 0.35);
      border: 1px solid rgba(148, 163, 184, 0.15);
      border-radius: 1rem;
      padding: 1rem 1.1rem 1.25rem;
    }
    .totals-card {
      background: rgba(15, 23, 42, 0.35);
      border: 1px solid rgba(148, 163, 184, 0.05);
      border-radius: 0.6rem;
      padding: 0.5rem 0.7rem 0.6rem;
      min-width: 180px;
      margin-bottom: 1rem;
    }
    .totals-card small { color: var(--muted); }
    .totals-card .big { font-size: 1.05rem; font-weight: 700; }
    .cum-wrap { margin-bottom: 1rem; }
    .cum-label { display:flex; justify-content:space-between; gap:1rem; font-size:0.75rem; margin-bottom:0.35rem; }
    .cum-bar {
      background: rgba(148, 163, 184, 0.15);
      border-radius: 999px;
      height: 13px;
      overflow: hidden;
    }
    .cum-fill {
      height: 13px;
      background: linear-gradient(90deg, #22c55e, #16a34a);
      width: 0%;
    }
    .result-list {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(210px, 1fr));
      gap: 0.6rem;
    }
    .result-item {
      background: rgba(15, 23, 42, 0.25);
      border: 1px solid rgba(148, 163, 184, 0.05);
      border-radius: 0.5rem;
      padding: 0.4rem 0.5rem 0.6rem;
    }
    .result-item small { color: var(--muted); font-size: 0.65rem; }
    .result-item .name { font-weight: 600; margin-bottom: 0.2rem; }
    .bar { background: rgba(148, 163, 184, 0.15); border-radius: 999px; height: 10px; overflow: hidden; margin-top: 0.35rem; }
    .bar-fill { height: 10px; background: linear-gradient(90deg, #22c55e, #16a34a); width: 0%; }
    @media (max-width: 600px) { body { padding: 1rem; } }
  </style>
</head>
<body>
  <div class="container">
    <h1>CivicReceipt</h1>
    <p class="subtitle">2024-ish federal shares baked in. You give income, it does the brackets, you pick slices.</p>

    <div class="grid">
      <div>
        <label for="income">Annual income (USD)</label>
        <input type="number" id="income" value="56000" min="0" step="500" />
      </div>
      <div>
        <label for="status">Filing status</label>
        <select id="status">
          <option value="single">Single</option>
          <option value="married">Married filing jointly</option>
          <option value="hoh">Head of household</option>
        </select>
      </div>
    </div>

    <h2 style="margin-top:1.2rem;font-size:1rem;">Select categories</h2>
    <p class="subtitle" style="margin-bottom:0.4rem;">These %'s are fixed. No edits.</p>
    <div class="category-list" id="categoryList"></div>
    <div class="cat-inputs" id="catInputs"></div>

    <button id="calcBtn">Calculate</button>

    <div class="results" id="results" style="display:none;">
      <div class="totals-card" id="taxCard">
        <small>Estimated 2024 federal income tax</small>
        <div class="big" id="totalTaxes">$0.00</div>
        <small id="taxDetails" style="display:block;margin-top:0.3rem;"></small>
      </div>

      <div class="cum-wrap">
        <div class="cum-label">
          <span>Selected categories total</span>
          <span id="cumText">$0.00 (0%)</span>
        </div>
        <div class="cum-bar">
          <div class="cum-fill" id="cumFill"></div>
        </div>
      </div>

      <div class="result-list" id="resultList"></div>
    </div>
  </div>

  <script>
    // fixed categories with updated DHS/ICE
    const CATEGORIES = [
      { id: "snap", name: "SNAP & Food Assistance", pct: 1.6 },
      { id: "healthcare", name: "Healthcare & Medicaid", pct: 14.0 },
      { id: "soldierpay", name: "Pay & Benefits for Soldiers", pct: 2.6 },
      { id: "weapons", name: "Weapons & Procurement", pct: 4.2 },
      { id: "infra", name: "Infrastructure & Transportation", pct: 2.0 },
      { id: "justice", name: "Law Enforcement & Justice", pct: 0.6 },
      { id: "homeland", name: "Homeland Security", pct: 1.4 },
      { id: "ice", name: "ICE & Detention/Removal", pct: 0.15 },
      { id: "env", name: "Environmental Protection", pct: 0.2 },
      { id: "foreign", name: "Foreign Aid & Diplomacy", pct: 1.2 },
      { id: "debt", name: "Interest on Debt", pct: 13.0 },
      { id: "subsidy", name: "Corporate / Farm-style Subsidies", pct: 0.2 }
    ];

    // 2024-ish brackets
    const IRS_2024 = {
      single: {
        deduction: 14600,
        brackets: [
          { upto: 11600, rate: 0.10 },
          { upto: 47150, rate: 0.12 },
          { upto: 100525, rate: 0.22 },
          { upto: 191950, rate: 0.24 },
          { upto: 243725, rate: 0.32 },
          { upto: 609350, rate: 0.35 },
          { upto: Infinity, rate: 0.37 }
        ]
      },
      married: {
        deduction: 29200,
        brackets: [
          { upto: 23200, rate: 0.10 },
          { upto: 94300, rate: 0.12 },
          { upto: 201050, rate: 0.22 },
          { upto: 383900, rate: 0.24 },
          { upto: 487450, rate: 0.32 },
          { upto: 731200, rate: 0.35 },
          { upto: Infinity, rate: 0.37 }
        ]
      },
      hoh: {
        deduction: 21900,
        brackets: [
          { upto: 16550, rate: 0.10 },
          { upto: 63100, rate: 0.12 },
          { upto: 100500, rate: 0.22 },
          { upto: 191950, rate: 0.24 },
          { upto: 243700, rate: 0.32 },
          { upto: 609350, rate: 0.35 },
          { upto: Infinity, rate: 0.37 }
        ]
      }
    };

    const categoryList = document.getElementById("categoryList");
    const catInputs = document.getElementById("catInputs");
    const resultList = document.getElementById("resultList");
    const resultsBox = document.getElementById("results");
    const cumFill = document.getElementById("cumFill");
    const cumText = document.getElementById("cumText");

    // render checkboxes
    CATEGORIES.forEach(cat => {
      const label = document.createElement("label");
      const cb = document.createElement("input");
      cb.type = "checkbox";
      cb.value = cat.id;
      cb.dataset.cat = cat.id;
      cb.addEventListener("change", onCategoryToggle);
      label.appendChild(cb);
      label.append(cat.name);
      categoryList.appendChild(label);
    });

    function onCategoryToggle(e) {
      const id = e.target.dataset.cat;
      const cat = CATEGORIES.find(c => c.id === id);
      if (!cat) return;
      if (e.target.checked) {
        const box = document.createElement("div");
        box.className = "cat-box";
        box.id = "box-" + id;
        box.innerHTML = `
          <strong>${cat.name}</strong>
          <small>Fixed at ${cat.pct}% of 2024 federal spending.</small>
        `;
        catInputs.appendChild(box);
      } else {
        const box = document.getElementById("box-" + id);
        if (box) box.remove();
      }
    }

    function computeTax(income, status) {
      const cfg = IRS_2024[status] || IRS_2024.single;
      const taxable = Math.max(0, income - cfg.deduction);
      let remaining = taxable;
      let lastCap = 0;
      let tax = 0;
      cfg.brackets.forEach(br => {
        if (remaining <= 0) return;
        const span = Math.min(remaining, br.upto - lastCap);
        tax += span * br.rate;
        remaining -= span;
        lastCap = br.upto;
      });
      return { tax, taxable, deduction: cfg.deduction };
    }

    function fmtDollar(num) {
      return "$" + num.toLocaleString(undefined, { minimumFractionDigits: 2, maximumFractionDigits: 2 });
    }

    function calculate() {
      const income = Number(document.getElementById("income").value) || 0;
      const status = document.getElementById("status").value;
      const { tax, taxable, deduction } = computeTax(income, status);

      document.getElementById("totalTaxes").textContent = fmtDollar(tax);
      document.getElementById("taxDetails").textContent =
        `Gross: ${fmtDollar(income)} – Std deduction: ${fmtDollar(deduction)} → Taxable: ${fmtDollar(taxable)}`;

      const selected = [];
      CATEGORIES.forEach(cat => {
        const cb = categoryList.querySelector(`input[value="${cat.id}"]`);
        if (cb && cb.checked) {
          selected.push(cat);
        }
      });

      resultList.innerHTML = "";
      if (selected.length === 0) {
        resultsBox.style.display = "block";
        resultList.innerHTML = "<p style='color:#94a3b8'>Select at least one category above.</p>";
        cumFill.style.width = "0%";
        cumText.textContent = "$0.00 (0%)";
        return;
      }

      // per-category output
      const amounts = selected.map(s => tax * (s.pct / 100));
      const maxAmount = Math.max(...amounts, 1);

      let cumulative = 0;

      selected.forEach((cat, idx) => {
        const amount = tax * (cat.pct / 100);
        cumulative += amount;
        const width = (amount / maxAmount) * 100;
        const item = document.createElement("div");
        item.className = "result-item";
        item.innerHTML = `
          <div class="name">${cat.name}</div>
          <small>${cat.pct}% of federal budget</small>
          <div style="margin-top:0.25rem;font-weight:600;">${fmtDollar(amount)}</div>
          <div class="bar"><div class="bar-fill" style="width:${width}%;"></div></div>
        `;
        resultList.appendChild(item);
      });

      // cumulative bar
      const cumPctOfTax = (cumulative / tax) * 100;
      cumFill.style.width = Math.min(100, cumPctOfTax) + "%";
      cumText.textContent = `${fmtDollar(cumulative)} (${cumPctOfTax.toFixed(1)}% of your tax)`;

      resultsBox.style.display = "block";
    }

    document.getElementById("calcBtn").addEventListener("click", calculate);

    // pre-check a few
    ["snap","soldierpay","homeland","ice"].forEach(id => {
      const cb = categoryList.querySelector(`input[value="${id}"]`);
      if (cb) {
        cb.checked = true;
        cb.dispatchEvent(new Event("change"));
      }
    });

    calculate();
  </script>
</body>
</html>
